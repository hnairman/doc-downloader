# 道客文档提取器

**版本**: v2.6.0
**更新时间**: 2025-10-13
**状态**: ✅ 稳定版本 (最新功能已集成)

## 🎯 项目简介

这是一个功能强大、稳定可靠的网页文档提取工具，专门用于提取doc88.com等网站的受保护文档内容。

### 核心特性
- **智能内容提取**: 自动检测并提取Canvas渲染的文档内容
- **空白Canvas过滤**: 自动跳过纯黑色空白页面，只提取有效内容
- **动态页面检测**: 自动识别文档页数，支持分页加载
- **滑块验证处理**: 智能识别并提示用户完成滑块验证
- **登录状态管理**: 自动检测登录状态，支持手动登录
- **PDF自动生成**: 将提取的图片自动生成高质量PDF文档
- **🆕 智能标题检测**: 自动提取文档标题作为PDF文件名
- **🆕 完善日志系统**: 详细的执行日志和错误追踪
- **🆕 用户体验优化**: 智能退出提示和进度显示

### 稳定性保障
- **权限问题处理**: 自动处理各种权限限制，智能选择保存位置
- **完善错误处理**: 全面的异常处理和自动重试机制
- **资源自动管理**: 智能的浏览器资源管理和清理
- **用户友好**: 提取完成后等待用户确认，不会自动退出

## 🆕 v2.6.0 新功能

### 智能标题检测与文件命名
- **自动标题提取**: 从页面标题、HTML元素、URL等多个来源智能提取文档标题
- **标题清理**: 自动移除网站名称、页数信息等无关内容
- **文件名优化**: 使用文档标题作为PDF文件名，支持中文和特殊字符处理
- **备选方案**: 无法检测标题时自动使用传统命名方式

### 用户体验增强
- **智能退出提示**: 程序完成后显示清晰的用户确认提示，避免闪退
- **详细进度显示**: 实时显示提取进度和状态信息
- **完善的错误提示**: 友好的错误信息和解决建议

### 文件名格式示例
```
✅ 有标题: "Python编程教程_45页_20250113_143052.pdf"
✅ 有标题(长): "机器学习实战：基于Scikit-Learn..._25页_20250113_143052.pdf"
✅ 无标题: "doc88提取_45页_20250113_143052.pdf"
```

## 🚀 快速开始

### 推荐启动方式

#### 方法1: 直接启动
```bash
python start_enhanced_extractor.py --url "https://www.doc88.com/p-74287148231067.html"
```

#### 方法2: 交互式输入
```bash
python start_enhanced_extractor.py
# 程序会提示您输入URL
```

#### 方法3: 批处理文件
```bash
# 双击运行
run_extractor.bat
```

### 使用步骤
1. **启动程序**: 使用任意方式启动
2. **输入URL**:  提供目标文档的URL，网页打开后点击网页顶部放大按钮，文件放大到最大            
3. **完成验证**: 根据提示完成登录，下拉网页，直到'继续阅读全文'按钮出现，滑动或点击按钮，加载全部文件内容
4. **等待提取**: 程序会自动完成所有操作，包括标题检测和内容提取
5. **查看结果**: 在项目目录内找到以文档标题命名的PDF文件




## 📁 项目结构

```
文档提取项目/
├── 🚀 start_enhanced_extractor.py    # 主启动脚本
├── 🖱️ run_extractor.bat               # 批处理启动脚本
├── 📋 README.md                       # 本文档
├── 📋 requirements.txt                # 依赖列表
├── 🔧 utils/                          # 工具模块
│   ├── config.py                      # 配置管理
│   └── logger.py                      # 日志管理
├── 🔧 工具脚本/                        # 提取工具
│   └── enhanced_extractor.py          # 增强版提取器
├── 📚 docs/                           # 文档目录
│   ├── guides/                        # 使用指南
│   │   ├── URL_GUIDE.md              # URL使用指南
│   │   ├── QUICK_START.md            # 快速开始
│   │   └── 启动器使用指南.md          # 启动器使用指南
│   ├── fixes/                         # 修复文档
│   │   ├── CRASH_FIX_GUIDE.md        # 闪退修复指南
│   │   ├── PERMISSION_FIX_GUIDE.md   # 权限修复指南
│   │   └── FIXES_SUMMARY.md          # 修复总结
│   └── legacy/                        # 历史文档
├── 📁 logs/                           # 日志文件目录
└── 📁 提取结果_YYYYMMDD_HHMMSS/       # 输出结果目录
```

## ⚙️ 配置选项

程序支持多种命令行参数：

```bash
python start_enhanced_extractor.py [选项]

选项:
  --url TEXT          目标文档URL (如果不提供，将交互式输入)
  --headless          无头模式运行 (不显示浏览器界面)
  --debug             启用调试模式
  --config TEXT       配置文件路径
  --log-level TEXT    日志级别 (DEBUG/INFO/WARNING/ERROR)
  --output-dir TEXT   自定义输出目录
  --help              显示帮助信息
```

## 🔧 系统要求

- **Python**: 3.8 或更高版本
- **操作系统**: Windows, macOS, Linux
- **浏览器**: Chromium (自动安装)
- **内存**: 至少 2GB 可用内存
- **磁盘空间**: 至少 1GB 可用空间

## 📦 安装

### 快速安装
```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 安装浏览器
python -m playwright install chromium

# 3. 运行程序
python start_enhanced_extractor.py
```

### 详细安装
请查看 [docs/guides/QUICK_START.md](docs/guides/QUICK_START.md)

## 🛠️ 故障排除

### 常见问题

1. **权限问题**: 查看 [docs/fixes/PERMISSION_FIX_GUIDE.md](docs/fixes/PERMISSION_FIX_GUIDE.md)
2. **闪退问题**: 查看 [docs/fixes/CRASH_FIX_GUIDE.md](docs/fixes/CRASH_FIX_GUIDE.md)
3. **完整修复总结**: 查看 [docs/fixes/FIXES_SUMMARY.md](docs/fixes/FIXES_SUMMARY.md)

### 获取帮助
- 📚 **文档中心**: [docs/README.md](docs/README.md) - 完整文档索引
- 📖 **功能特性**: [docs/FEATURES.md](docs/FEATURES.md) - 详细功能说明
- 🏗️ **技术架构**: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md) - 系统设计文档
- 📋 **使用指南**: [docs/guides/](docs/guides/) - 快速开始和详细使用说明
- 🔧 **故障排除**: [docs/fixes/](docs/fixes/) - 常见问题解决方案
- 📜 **更新日志**: [CHANGELOG.md](CHANGELOG.md) - 版本更新记录

## 📄 许可证

本项目仅供学习和研究使用。使用时请遵守相关法律法规和网站使用条款。

**免责声明**: 本工具仅用于个人学习和研究目的。用户应遵守目标网站的使用条款，尊重知识产权，不得用于商业用途或任何违法违规行为。

---

**最后更新**: 2025-10-13
**版本**: v2.6.0 (智能标题检测)
**状态**: 稳定版本，所有已知问题已修复

## 📋 版本历史

### v2.6.0 (2025-10-13)
- ✨ **新增**: 智能标题检测功能
- ✨ **新增**: 文档标题自动提取作为PDF文件名
- ✨ **新增**: 标题清理和文件名优化
- ✨ **新增**: 用户体验优化（智能退出提示）
- 🔧 **改进**: 完善的日志系统和错误处理
- 🔧 **改进**: 批处理脚本退出提示优化

### v2.5.0 (2025-10-12)
- 🐛 **修复**: 批处理文件重复退出提示问题
- 🔧 **改进**: 控制台输出优化
- 📝 **文档**: 更新使用指南

### v2.4.0 及更早版本
- 🎯 **核心功能**: Canvas内容提取
- 🎯 **核心功能**: PDF自动生成
- 🎯 **核心功能**: 权限处理和错误恢复

- 🎯 **核心功能**: 多种文档网站支持
